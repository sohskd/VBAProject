Sub test1()    Dim s As String    s = "EFGHIJKLM"        For J = 5 To 18        For I = 1 To Len(s)            Debug.Print Mid(s, I, 1) & J        Next    NextEnd Sub
Sub MakeReportTableUSD()
    Dim wb       As Workbook    Dim wbTarget As Workbook    Dim sheetTargetName As String    Dim s As String    '    Original HardCode'    Set wb = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\GenerateTablesFormulas.xlsx")'    Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")    sheetTargetName = "USD_NII_Sensitivity"        'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")        'Table Formulas Template    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))        'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    targetPath = ThisWorkbook.Sheets("Sheet1").Range("C6")    'Name of File eg Report.xlsx    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("C7"))        'Paste the format of table    With wb.Sheets("USDReportTemplate").UsedRange        .Copy    End With
    wbTarget.Sheets(sheetTargetName).Select    With wbTarget.Sheets(sheetTargetName).Range("C1")        .PasteSpecial    End With        'Variables to loop through    sReport = "EFGHIJKLM"    sSource = "FGHIJKLMN"        'Generating INTEREST EARNING ASSETS    'Go vertical down    For J = 5 To 9        'Go across        For I = 1 To Len(sReport)                wbTarget.Sheets(sheetTargetName).Range(Mid(sReport, I, 1) & J) = "=SG_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+MY_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+BOS_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+London_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+Labuan_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+NY_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+NISP_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+HK_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+OWH_USD!" & Mid(sSource, I, 1) & J + 79        '        wbTarget.Sheets(sheetTargetName).Range(Mid(sReport, I, 1) & J) = "=HK_USD!" & Mid(sSource, I, 1) & J + 79 _'        & "+London_USD!" & Mid(sSource, I, 1) & J + 79 _'        & "+Labuan_USD!" & Mid(sSource, I, 1) & J + 79 _'        & "+NY_USD!" & Mid(sSource, I, 1) & J + 79 _'        & "+NISP_USD!" & Mid(sSource, I, 1) & J + 79 _'        & "+MY_USD!" & Mid(sSource, I, 1) & J + 79 _'        & "+SG_USD!" & Mid(sSource, I, 1) & J + 79 _'        & "+OWH_USD!" & Mid(sSource, I, 1) & J + 79
        Next    Next        'Generating INTEREST BEARING LIABILITIES    'Go vertical down    For J = 11 To 18        'Go across        For I = 1 To Len(sReport)                wbTarget.Sheets(sheetTargetName).Range(Mid(sReport, I, 1) & J) = "=SG_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+MY_USD!" & Mid(sSource, I, 1) & J + 79 _        & "+BOS_USD!" & Mid(sSource, I, 1) & J + 79 _        & "-London_USD!" & Mid(sSource, I, 1) & J + 79 _        & "-Labuan_USD!" & Mid(sSource, I, 1) & J + 79 _        & "-NY_USD!" & Mid(sSource, I, 1) & J + 79 _        & "-NISP_USD!" & Mid(sSource, I, 1) & J + 79 _        & "-HK_USD!" & Mid(sSource, I, 1) & J + 79 _        & "-OWH_USD!" & Mid(sSource, I, 1) & J + 79
        Next    Next        'Generating Funding Swaps from SG_USD    'Go across    For I = 1 To Len(sReport)        wbTarget.Sheets(sheetTargetName).Range(Mid(sReport, I, 1) & 19) = "=SG_USD!" & Mid(sSource, I, 1) & 98
    Next        'Close and save all files    wb.Close SaveChanges:=True    wbTarget.Close SaveChanges:=True   End Sub
