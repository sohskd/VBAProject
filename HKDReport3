Sub MakeReportTableHKD()
    Dim wb As Workbook    Dim wbTarget As Workbook    Dim sheetTargetName As String    Dim s As String    '    Original HardCode'    Set wb = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\GenerateTablesFormulas.xlsx")'    Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")    sheetTargetName = "HKD_NII_Sensitivity"        'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")        'Table Formulas Template    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))        'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    targetPath = ThisWorkbook.Sheets("Sheet1").Range("H6")    'Name of File eg Report.xlsx    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("H7"))        'Paste the format of table    With wb.Sheets("HKDReportTemplate").UsedRange        .Copy    End With
    wbTarget.Sheets(sheetTargetName).Select    With wbTarget.Sheets(sheetTargetName).Range("C1")        .PasteSpecial    End With        'Variables to loop through    sReport = "EFGHIJKLM"    sSource = "FGHIJKLMN"        'Generating INTEREST EARNING ASSETS    'Go vertical down    For J = 5 To 9        'Go across        For I = 1 To Len(sReport)                wbTarget.Sheets(sheetTargetName).Range(Mid(sReport, I, 1) & J) = "=OWH_HKD!" & Mid(sSource, I, 1) & J + 79 _        & "+HK_HKD!" & Mid(sSource, I, 1) & J + 79 _        & "+BOS_HKD!" & Mid(sSource, I, 1) & J + 79
        Next    Next        'Generating INTEREST BEARING LIABILITIES    'Go vertical down    For J = 11 To 18        'Go across        For I = 1 To Len(sReport)                wbTarget.Sheets(sheetTargetName).Range(Mid(sReport, I, 1) & J) = "=OWH_HKD!" & Mid(sSource, I, 1) & J + 79 _        & "+HK_HKD!" & Mid(sSource, I, 1) & J + 79 _        & "+BOS_HKD!" & Mid(sSource, I, 1) & J + 79
        Next    Next        'Generating NET GAP    'Go across    For I = 1 To Len(sReport)
    wbTarget.Sheets(sheetTargetName).Range(Mid(sReport, I, 1) & 18) = "=" & Mid(sReport, I, 1) & 4 & "+" & Mid(sReport, I, 1) & 10 & "+" & Mid(sReport, I, 1) & 17
    Next        'Close and save all files    wb.Close SaveChanges:=True    wbTarget.Close SaveChanges:=True    End Sub
