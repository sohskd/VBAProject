Sub MakeSummaryTab()
    Dim wb       As Workbook    Dim wbTarget As Workbook    Dim sheetTargetName As String    Dim s As String        Application.DisplayAlerts = False        'Setting the variables for paths    'Original HardCode    'targetPath = ThisWorkbook.Sheets("Sheet1").Range("C6")    'Set wb = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\GenerateTablesFormulas.xlsx")    sheetTargetName = "SummaryTab"        'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")        'Table Formulas Template    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))        'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    targetPath = ThisWorkbook.Sheets("Sheet1").Range("C6")    'Name of File eg Report.xlsx    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("C7"))        'Create the SummaryTab Sheet    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("C7"))        With wbTarget        .Sheets.Add(Before:=Worksheets(1)).name = "SummaryTab"        End With        'Paste the format of Summary Tab using a template    With wb.Sheets("SummarySpreadSheet").UsedRange        .Copy    End With
    wbTarget.Sheets(sheetTargetName).Select    With wbTarget.Sheets(sheetTargetName).Range("C1")        .PasteSpecial    End With        Application.CutCopyMode = False        'Link the summary Tab to other NII Sensitivity reports    wbTarget.Sheets(sheetTargetName).Range("M3") = "=USD_NII_Sensitivity!L229"    wbTarget.Sheets(sheetTargetName).Range("N3") = "=USD_NII_Sensitivity!N229"    wbTarget.Sheets(sheetTargetName).Range("M7") = "=USD_NII_Sensitivity!L230"    wbTarget.Sheets(sheetTargetName).Range("N7") = "=USD_NII_Sensitivity!N230"        wbTarget.Sheets(sheetTargetName).Range("I3") = "=SGD_NII_Sensitivity!K173"    wbTarget.Sheets(sheetTargetName).Range("J3") = "=SGD_NII_Sensitivity!M173"    wbTarget.Sheets(sheetTargetName).Range("I7") = "=SGD_NII_Sensitivity!K174"    wbTarget.Sheets(sheetTargetName).Range("J7") = "=SGD_NII_Sensitivity!M174"        'Close and save all files    wb.Close SaveChanges:=True    wbTarget.Close SaveChanges:=True        'Create the event procedure 2 way linkage    Call CreateEventProcedure        Application.DisplayAlerts = True
End SubSub CodeForUSDNIISensitivity()'Private Sub Worksheet_Change(ByVal Target As Range)''    MsgBox Target.Address'    Application.EnableEvents = False'    If Target.Address = "$O$13" Then'        Worksheets("SummaryTab").Range("E10") = Target.Value'    End If'    If Target.Address = "$O$14" Then'        Worksheets("SummaryTab").Range("E11") = Target.Value'    End If'    If Target.Address = "$O$15" Then'        Worksheets("SummaryTab").Range("E12") = Target.Value'    End If'    Application.EnableEvents = True'End SubEnd Sub
Sub CodeForSummaryTab()'Private Sub Worksheet_Change(ByVal Target As Range)''    MsgBox Target.Address'    Application.EnableEvents = False'    If Target.Address = "$E$10" Then'        Worksheets("USD_NII_Sensitivity").Range("O13") = Target.Value'    End If'    If Target.Address = "$E$11" Then'        Worksheets("USD_NII_Sensitivity").Range("O14") = Target.Value'    End If'    If Target.Address = "$E$12" Then'        Worksheets("USD_NII_Sensitivity").Range("O15") = Target.Value'    End If'    Application.EnableEvents = True'End SubEnd Sub
Function CreateEventProcedure()        Dim VBProj As VBIDE.VBProject        Dim VBComp As VBIDE.VBComponent        Dim CodeMod As VBIDE.CodeModule        Dim LineNum As Long        Const DQUOTE = """" ' one " character        Dim wbTarget As Workbook        Dim wsTarget As String                'Setting the variables for paths        targetPath = ThisWorkbook.Sheets("Sheet1").Range("C6")        Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("C7"))                Set VBProj = ActiveWorkbook.VBProject                'Writing the change event code for SummaryTab                Set VBComp = VBProj.VBComponents(Worksheets("SummaryTab").CodeName)                Set CodeMod = VBComp.CodeModule                With CodeMod            LineNum = .CreateEventProc("Change", "Worksheet")                        LineNum = LineNum + 1            .InsertLines LineNum, "Application.EnableEvents = False"                        LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "E" & Chr(36) & "10" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "USD_NII_Sensitivity" & DQUOTE & ").Range(" & DQUOTE & "O13" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"            LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "E" & Chr(36) & "11" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "USD_NII_Sensitivity" & DQUOTE & ").Range(" & DQUOTE & "O14" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"            LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "E" & Chr(36) & "12" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "USD_NII_Sensitivity" & DQUOTE & ").Range(" & DQUOTE & "O15" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"            LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "E" & Chr(36) & "17" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SGD_NII_Sensitivity" & DQUOTE & ").Range(" & DQUOTE & "M34" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"            LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "E" & Chr(36) & "18" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SGD_NII_Sensitivity" & DQUOTE & ").Range(" & DQUOTE & "M35" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"            LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "E" & Chr(36) & "19" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SGD_NII_Sensitivity" & DQUOTE & ").Range(" & DQUOTE & "M36" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"                        LineNum = LineNum + 1            .InsertLines LineNum, "Application.EnableEvents = True"        End With                'Writing the change event code for USD_NII_Sensitivity                Set VBComp = VBProj.VBComponents(Worksheets("USD_NII_Sensitivity").CodeName)                Set CodeMod = VBComp.CodeModule                With CodeMod            LineNum = .CreateEventProc("Change", "Worksheet")                        LineNum = LineNum + 1            .InsertLines LineNum, "Application.EnableEvents = False"                        LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "O" & Chr(36) & "13" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SummaryTab" & DQUOTE & ").Range(" & DQUOTE & "E10" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"            LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "O" & Chr(36) & "14" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SummaryTab" & DQUOTE & ").Range(" & DQUOTE & "E11" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"            LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "O" & Chr(36) & "15" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SummaryTab" & DQUOTE & ").Range(" & DQUOTE & "E12" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"'            LineNum = LineNum + 1'            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "M" & Chr(36) & "34" & DQUOTE & "Then"'            LineNum = LineNum + 1'            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SummaryTab" & DQUOTE & ").Range(" & DQUOTE & "E17" & DQUOTE & ") = Target.Value"'            LineNum = LineNum + 1'            .InsertLines LineNum, "End If"'            LineNum = LineNum + 1'            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "M" & Chr(36) & "35" & DQUOTE & "Then"'            LineNum = LineNum + 1'            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SummaryTab" & DQUOTE & ").Range(" & DQUOTE & "E18" & DQUOTE & ") = Target.Value"'            LineNum = LineNum + 1'            .InsertLines LineNum, "End If"'            LineNum = LineNum + 1'            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "M" & Chr(36) & "36" & DQUOTE & "Then"'            LineNum = LineNum + 1'            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SummaryTab" & DQUOTE & ").Range(" & DQUOTE & "E19" & DQUOTE & ") = Target.Value"'            LineNum = LineNum + 1'            .InsertLines LineNum, "End If"                        LineNum = LineNum + 1            .InsertLines LineNum, "Application.EnableEvents = True"        End With                'Writing the change event code for SGD_NII_Sensitivity                Set VBComp = VBProj.VBComponents(Worksheets("SGD_NII_Sensitivity").CodeName)                Set CodeMod = VBComp.CodeModule                With CodeMod            LineNum = .CreateEventProc("Change", "Worksheet")                        LineNum = LineNum + 1            .InsertLines LineNum, "Application.EnableEvents = False"                        LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "M" & Chr(36) & "34" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SummaryTab" & DQUOTE & ").Range(" & DQUOTE & "E17" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"            LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "M" & Chr(36) & "35" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SummaryTab" & DQUOTE & ").Range(" & DQUOTE & "E18" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"            LineNum = LineNum + 1            .InsertLines LineNum, "If Target.Address =" & DQUOTE & Chr(36) & "M" & Chr(36) & "36" & DQUOTE & "Then"            LineNum = LineNum + 1            .InsertLines LineNum, "Worksheets(" & DQUOTE & "SummaryTab" & DQUOTE & ").Range(" & DQUOTE & "E19" & DQUOTE & ") = Target.Value"            LineNum = LineNum + 1            .InsertLines LineNum, "End If"                        LineNum = LineNum + 1            .InsertLines LineNum, "Application.EnableEvents = True"        End With        End Function
