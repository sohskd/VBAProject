'This module contains the Subroutine to generate the tables for each format'If there is a different format, a new subroutine has to be written for that format'If the format changes, the subroutine has to change
'Subroutine to generate USD tables
Sub MakeTableUSD()
    Dim wb       As Workbook    Dim wbTarget As Workbook    Dim sheetTargetName As String    Dim WS_Count As Integer    Dim I As Integer        'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")        'Table Formulas Template    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))    'Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")        'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    targetPath = ThisWorkbook.Sheets("Sheet1").Range("C6")    'Name of File eg Report.xlsx    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("C7"))    WS_Count = ActiveWorkbook.Worksheets.Count
    ' Begin the loop.    For I = 1 To WS_Count            wbTarget.Sheets(I).Select            If ActiveSheet.name = "HK_USD" Or ActiveSheet.name = "London_USD" Or ActiveSheet.name = "NY_USD" _        Or ActiveSheet.name = "NISP_USD" Or ActiveSheet.name = "Labuan_USD" Then            'Copy and Paste the format of table        With wb.Sheets("USDTableTemplate").UsedRange            .Copy        End With                With wbTarget.Sheets(I).Range("D82")            .PasteSpecial        End With            'Make the formulas                '''''Interbank Placement        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G84").Select        ActiveCell.FormulaR1C1 = "=R[-69]C[1]*R2C25/1000000000"        Range("G84").Select        Selection.AutoFill Destination:=Range("G84:K84"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-69]C:R[-69]C[1])*R2C25/1000000000"                '>1Y        wbTarget.Sheets(I).Range("L84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-69]C[1]:R[-69]C[8])*R2C25/1000000000"                'Non-Rate        wbTarget.Sheets(I).Range("M84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-69]C[8])*R2C25/1000000000"                'Total        wbTarget.Sheets(I).Range("N84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-69]C[8]+R[-75]C[8])*R2C25/1000000000"            '''''Corporate Bonds        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G85").Select        ActiveCell.FormulaR1C1 = "=R[-74]C[1]/10^9*R2C25"        Range("G85").Select        Selection.AutoFill Destination:=Range("G85:K85"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-74]C:R[-74]C[1])*R2C25/1000000000"                '>1Y        wbTarget.Sheets(I).Range("L85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-74]C[1]:R[-74]C[8])*R2C25/1000000000"                'Non-Rate        wbTarget.Sheets(I).Range("M85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-74]C[8])/10^9*R2C25"                'Total        wbTarget.Sheets(I).Range("N85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-74]C[8])*R2C25/1000000000"                '''''Government Bonds and T - Bills        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G86").Select        ActiveCell.FormulaR1C1 = "=(R[-75]C[1])*R2C25/1000000000"        Range("G86").Select        Selection.AutoFill Destination:=Range("G86:K86"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-75]C:R[-75]C[1])*R2C25/1000000000"                '>1Y        wbTarget.Sheets(I).Range("L86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-75]C[1]:R[-75]C[8])*R2C25/1000000000"                'Non-Rate        wbTarget.Sheets(I).Range("M86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-75]C[8])/1000000000*R2C25"                'Total        wbTarget.Sheets(I).Range("N86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-75]C[8])*R2C25/1000000000"            '''''Customer Loans        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G87").Select        ActiveCell.FormulaR1C1 = "=(R[-70]C[1]+R[-69]C[1])/10^9*R2C25"        Range("G87").Select        Selection.AutoFill Destination:=Range("G87:K87"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-70]C:R[-69]C[1])*R2C25/1000000000"                '>1Y        wbTarget.Sheets(I).Range("L87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-70]C[1]:R[-69]C[8])*R2C25/1000000000"                'Non-Rate        wbTarget.Sheets(I).Range("M87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-70]C[8]+R[-69]C[8])/1000000000*R2C25"                'Total        wbTarget.Sheets(I).Range("N87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-70]C[8]+R[-69]c[8])*R2C25/1000000000"            '''''Interbank Borrowing        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G90").Select        ActiveCell.FormulaR1C1 = "=R[-50]C[1]/10^9*R2C25"        Range("G90").Select        Selection.AutoFill Destination:=Range("G90:K90"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-50]C:R[-50]C[1])*R2C25/1000000000"                '>1Y        wbTarget.Sheets(I).Range("L90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-50]C[1]:R[-50]C[8])*R2C25/1000000000"                'Non-Rate        wbTarget.Sheets(I).Range("M90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-50]C[8])/1000000000*R2C25"                'Total        wbTarget.Sheets(I).Range("N90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-50]C[8])*R2C25/1000000000"            '''''CPS/Debt Issued        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G91").Select        ActiveCell.FormulaR1C1 = "=R[-52]C[1]/10^9*R2C25"        Range("G91").Select        Selection.AutoFill Destination:=Range("G91:K91"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F91").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-52]C:R[-52]C[1])*R2C25/1000000000"                '>1Y        wbTarget.Sheets(I).Range("L91").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-52]C[1]:R[-52]C[8])*R2C25/1000000000"                'Non-Rate        wbTarget.Sheets(I).Range("M91").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-52]C[8])/1000000000*R2C25"                'Total        wbTarget.Sheets(I).Range("N91").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-52]C[8])*R2C25/1000000000"            '''''Fixed Deposits/SD/Others        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G95").Select        ActiveCell.FormulaR1C1 = "=(R[-54]C[1]+R[-53]C[1])/10^9*R2C25-R[-3]C"        Range("G95").Select        Selection.AutoFill Destination:=Range("G95:K95"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-54]C:R[-53]C[1])*R2C25/1000000000"                '>1Y        wbTarget.Sheets(I).Range("L95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-54]C[1]:R[-53]C[8])*R2C25/1000000000"                'Non-Rate        wbTarget.Sheets(I).Range("M95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C[8]+R[-54]C[8])/1000000000*R2C25 - R[-2]"                'Total        wbTarget.Sheets(I).Range("N95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C[8]+R[-54]C[8])*R2C25/1000000000"                '''''CDs        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G96").Select        ActiveCell.FormulaR1C1 = "=R[-53]C[1]/10^9*R2C25"        Range("G96").Select        Selection.AutoFill Destination:=Range("G96:K96"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F96").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C:R[-53]C[1])*R2C25/1000000000"                '>1Y        wbTarget.Sheets(I).Range("L96").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C[1]:R[-53]C[8])*R2C25/1000000000"                'Non-Rate        wbTarget.Sheets(I).Range("M96").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C[8])/10^9*R2C25"                'Total        wbTarget.Sheets(I).Range("N96").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C[8])*R2C25/1000000000"            '''''Derivatives        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G97").Select        ActiveCell.FormulaR1C1 = "=R[-33]C[1]/10^9*R2C25"        Range("G97").Select        Selection.AutoFill Destination:=Range("G97:K97"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-33]C:R[-33]C[1])*R2C25/1000000000"                '>1Y        wbTarget.Sheets(I).Range("L97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-33]C[1]:R[-33]C[8])*R2C25/1000000000"                'Non-Rate        wbTarget.Sheets(I).Range("M97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-33]C[8])/1000000000*R2C25"                'Total        wbTarget.Sheets(I).Range("N97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-33]C[8])*R2C25/1000000000"                End If        Next I        wb.Close SaveChanges:=True    wbTarget.Close SaveChanges:=True    End Sub
Sub MakeTablesUSDSG()
    Dim wb       As Workbook    Dim wbTarget As Workbook    Dim sheetTargetName As String    Dim WS_Count As Integer    Dim I As Integer
'    Original code Hardcode'    Set wb = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\GenerateTablesFormulas.xlsx")'    Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")'    WS_Count = ActiveWorkbook.Worksheets.Count
'    'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"'    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")''    'Table Formulas Template'    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))'    'Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")'    WS_Count = ActiveWorkbook.Worksheets.Count''    'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"'    targetPath = ThisWorkbook.Sheets("Sheet1").Range("C6")'    'Name of File eg Report.xlsx'    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("C7"))
    'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")        'Table Formulas Template    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))        'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    targetPath = ThisWorkbook.Sheets("Sheet1").Range("H6")    'Name of File eg Report.xlsx    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("H7"))        'Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")    WS_Count = ActiveWorkbook.Worksheets.Count    Debug.Print WS_Count
    ' Begin the loop.    For I = 1 To WS_Count            wbTarget.Sheets(I).Select            If ActiveSheet.name = "SG_USD" Then            'Copy and Paste the format of table        With wb.Sheets("USDTableTemplate").UsedRange            .Copy        End With                With wbTarget.Sheets(I).Range("D82")            .PasteSpecial        End With            'Make the formulas                'Interbank Placement        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G84").Select        ActiveCell.FormulaR1C1 = "=((R[-80]C+R[-75]C)/1000)"        Range("G84").Select        Selection.AutoFill Destination:=Range("G84:K84"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-80]C[-1]:R[-80]C+R[-75]C[-1]:R[-75]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L84").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-80]C:R[-80]C[7])+SUM(R[-75]C:R[-75]C[7]))/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-80]C[8]+R[-75]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-80]C[8]+R[-75]c[8])/1000"                '''''Corporate Bonds        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G85").Select        ActiveCell.FormulaR1C1 = "=(R[-78]C)/1000"        Range("G85").Select        Selection.AutoFill Destination:=Range("G85:K85"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-78]C[-1]:R[-78]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-78]C:R[-78]C[7])/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-78]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-78]C[8])/1000"                        '''''Government Bonds and T - Bills        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G86").Select        ActiveCell.FormulaR1C1 = "=(R[-78]C)/1000"        Range("G86").Select        Selection.AutoFill Destination:=Range("G86:K86"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-78]C[-1]:R[-78]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-78]C:R[-78]C[7])/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-78]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-78]C[8])/1000"                    '''''Customer Loans        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G87").Select        ActiveCell.FormulaR1C1 = "=(R[-77]C - SUM(R[-76]C+R[-73]C+R[-70]C+R[-67]C+R[-64]C+R[-61]C+R[-58]C+R[-46]C+R[-41]C))/1000"        Range("G87").Select        Selection.AutoFill Destination:=Range("G87:K87"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F87").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-77]C[-1]+R[-77]C) - SUM(R[-76]C[-1]+R[-76]C+R[-73]C[-1]+R[-73]C+R[-70]C[-1]+R[-70]C+R[-67]C[-1]+R[-67]C+R[-64]C[-1]+R[-64]C+R[-61]C[-1]+R[-61]C+R[-58]C[-1]+R[-58]C+R[-46]C[-1]+R[-46]C+R[-41]C[-1]+R[-41]C))/1000"                '>1Y        wbTarget.Sheets(I).Range("L87").Select        ActiveCell.FormulaR1C1 = "=(R[-77]C - SUM(R[-76]C+R[-73]C+R[-70]C+R[-67]C+R[-64]C+R[-61]C+R[-58]C+R[-46]C+R[-41]C+R[-76]C[1]+R[-73]C[1]+R[-70]C[1]+R[-67]C[1]+R[-64]C[1]+R[-61]C[1]+R[-58]C[1]+R[-46]C[1]+R[-41]C[1]+R[-76]C[2]+R[-73]C[2]+R[-70]C[2]+R[-67]C[2]+R[-64]C[2]+R[-61]C[2]+R[-58]C[2]+R[-46]C[2]+R[-41]C[2]+R[-76]C[3]+R[-73]C[3]+R[-70]C[3]+R[-67]C[3]+R[-64]C[3]+R[-61]C[3]+R[-58]C[3]+R[-46]C[3]+R[-41]C[3]+R[-76]C[3]+R[-73]C[3]+R[-70]C[3]+R[-67]C[3]+R[-64]C[3]+R[-61]C[3]+R[-58]C[3]+R[-46]C[3]+R[-41]C[3]+R[-76]C[4]+R[-73]C[4]+R[-70]C[4]+R[-67]C[4]+R[-64]C[4]+R[-61]C[4]+R[-58]C[4]+R[-46]C[4]+R[-41]C[4]+R[-76]C[5]+R[-73]C[5]+R[-70]C[5]+R[-67]C[5]+R[-64]C[5]+R[-61]C[5]+R[-58]C[5]+R[-46]C[5]+R[-41]C[5]+R[-76]C[6]+R[-73]C[6]+R[-70]C[6]+R[-67]C[6]+R[-64]C[6]+R[-61]C[6]+R[-58]C[6]+R[-46]C[6]+R[-41]C[6]+R[-76]C[7]+R[-73]C[7]+R[-70]C[7]+R[-67]C[7]+R[-64]C[7]+R[-61]C[7]+R[-58]C[7]+R[-46]C[7]+R[-41]C[7]))/1000"        '"+R[-76]C[1]+R[-73]C[1]+R[-70]C[1]+R[-67]C[1]+R[-64]C[1]+R[-61]C[1]+R[-58]C[1]+R[-46]C[1]+R[-41]C[1]"        '"+R[-76]C[2]+R[-73]C[2]+R[-70]C[2]+R[-67]C[2]+R[-64]C[2]+R[-61]C[2]+R[-58]C[2]+R[-46]C[2]+R[-41]C[2]"        '"+R[-76]C[3]+R[-73]C[3]+R[-70]C[3]+R[-67]C[3]+R[-64]C[3]+R[-61]C[3]+R[-58]C[3]+R[-46]C[3]+R[-41]C[3]"        '"+R[-76]C[4]+R[-73]C[4]+R[-70]C[4]+R[-67]C[4]+R[-64]C[4]+R[-61]C[4]+R[-58]C[4]+R[-46]C[4]+R[-41]C[4]"        '"+R[-76]C[5]+R[-73]C[5]+R[-70]C[5]+R[-67]C[5]+R[-64]C[5]+R[-61]C[5]+R[-58]C[5]+R[-46]C[5]+R[-41]C[5]"        '"+R[-76]C[6]+R[-73]C[6]+R[-70]C[6]+R[-67]C[6]+R[-64]C[6]+R[-61]C[6]+R[-58]C[6]+R[-46]C[6]+R[-41]C[6]"        '"+R[-76]C[7]+R[-73]C[7]+R[-70]C[7]+R[-67]C[7]+R[-64]C[7]+R[-61]C[7]+R[-58]C[7]+R[-46]C[7]+R[-41]C[7]"                'Non-Rate        wbTarget.Sheets(I).Range("M87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-77]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N87").Select        ActiveCell.FormulaR1C1 = "=SUM(RC[-8]:RC[-1])"                '''''Board        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G88").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-77]C+R[-74]C+R[-71]C+R[-68]C+R[-65]C+R[-62]C+R[-59]C+R[-47]C+R[-42]C))/1000"        Range("G88").Select        Selection.AutoFill Destination:=Range("G88:K88"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F88").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-77]C[-1]+R[-77]C+R[-74]C[-1]+R[-74]C+R[-71]C[-1]+R[-71]C+R[-68]C[-1]+R[-68]C+R[-65]C[-1]+R[-65]C+R[-62]C[-1]+R[-62]C+R[-59]C[-1]+R[-59]C+R[-47]C[-1]+R[-47]C+R[-42]C[-1]+R[-42]C))/1000"                '>1Y        wbTarget.Sheets(I).Range("L88").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-77]C+R[-74]C+R[-71]C+R[-68]C+R[-65]C+R[-62]C+R[-59]C+R[-47]C+R[-42]C+R[-77]C[1]+R[-74]C[1]+R[-71]C[1]+R[-68]C[1]+R[-65]C[1]+R[-62]C[1]+R[-59]C[1]+R[-47]C[1]+R[-42]C[1]+R[-77]C[2]+R[-74]C[2]+R[-71]C[2]+R[-68]C[2]+R[-65]C[2]+R[-62]C[2]+R[-59]C[2]+R[-47]C[2]+R[-42]C[2]+R[-77]C[3]+R[-74]C[3]+R[-71]C[3]+R[-68]C[3]+R[-65]C[3]+R[-62]C[3]+R[-59]C[3]+R[-47]C[3]+R[-42]C[3]+R[-77]C[4]+R[-74]C[4]+R[-71]C[4]+R[-68]C[4]+R[-65]C[4]+R[-62]C[4]+R[-59]C[4]+R[-47]C[4]+R[-42]C[4]+R[-77]C[5]+R[-74]C[5]+R[-71]C[5]+R[-68]C[5]+R[-65]C[5]+R[-62]C[5]+R[-59]C[5]+R[-47]C[5]+R[-42]C[5]+R[-77]C[6]+R[-74]C[6]+R[-71]C[6]+R[-68]C[6]+R[-65]C[6]+R[-62]C[6]+R[-59]C[6]+R[-47]C[6]+R[-42]C[6]+R[-77]C[7]+R[-74]C[7]+R[-71]C[7]+R[-68]C[7]+R[-65]C[7]+R[-62]C[7]+R[-59]C[7]+R[-47]C[7]+R[-42]C[7]))/1000"        '"+R[-77]C[1]+R[-74]C[1]+R[-71]C[1]+R[-68]C[1]+R[-65]C[1]+R[-62]C[1]+R[-59]C[1]+R[-47]C[1]+R[-42]C[1]"        '"+R[-77]C[2]+R[-74]C[2]+R[-71]C[2]+R[-68]C[2]+R[-65]C[2]+R[-62]C[2]+R[-59]C[2]+R[-47]C[2]+R[-42]C[2]"        '"+R[-77]C[3]+R[-74]C[3]+R[-71]C[3]+R[-68]C[3]+R[-65]C[3]+R[-62]C[3]+R[-59]C[3]+R[-47]C[3]+R[-42]C[3]"        '"+R[-77]C[4]+R[-74]C[4]+R[-71]C[4]+R[-68]C[4]+R[-65]C[4]+R[-62]C[4]+R[-59]C[4]+R[-47]C[4]+R[-42]C[4]"        '"+R[-77]C[5]+R[-74]C[5]+R[-71]C[5]+R[-68]C[5]+R[-65]C[5]+R[-62]C[5]+R[-59]C[5]+R[-47]C[5]+R[-42]C[5]"        '"+R[-77]C[6]+R[-74]C[6]+R[-71]C[6]+R[-68]C[6]+R[-65]C[6]+R[-62]C[6]+R[-59]C[6]+R[-47]C[6]+R[-42]C[6]"        '"+R[-77]C[7]+R[-74]C[7]+R[-71]C[7]+R[-68]C[7]+R[-65]C[7]+R[-62]C[7]+R[-59]C[7]+R[-47]C[7]+R[-42]C[7]"                'Non-Rate        wbTarget.Sheets(I).Range("M88").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-78]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N88").Select        ActiveCell.FormulaR1C1 = "=SUM(RC[-8]:RC[-1])"            '''''Interbank Borrowing        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G90").Select        ActiveCell.FormulaR1C1 = "=(R[-53]C)/1000"        Range("G90").Select        Selection.AutoFill Destination:=Range("G90:K90"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C[-1]:R[-53]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C:R[-53]C[7])/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-53]C[8])/1000"                    '''''CPS/Debt Issued        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G91").Select        ActiveCell.FormulaR1C1 = "=((R[-41]C+R[-37]C)/1000)"        Range("G91").Select        Selection.AutoFill Destination:=Range("G91:K91"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F91").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-41]C[-1]:R[-41]C+R[-37]C[-1]:R[-37]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L91").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-41]C:R[-41]C[7])+SUM(R[-37]C:R[-37]C[7]))/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M91").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-41]C[8]+R[-37]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N91").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-41]C[8]+R[-37]c[8])/1000"                '''''Current Account Board        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G93").Select        ActiveCell.FormulaR1C1 = "=((R[-52]C+R[-49]C+R[-51]C)/1000)"        Range("G93").Select        Selection.AutoFill Destination:=Range("G93:K93"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F93").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-52]C[-1]:R[-52]C+R[-49]C[-1]:R[-49]C+R[-51]C[-1]:R[-51]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L93").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-52]C:R[-52]C[7])+SUM(R[-49]C:R[-49]C[7])+SUM(R[-51]C:R[-51]C[7]))/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M93").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-52]C[8]+R[-49]C[8]+R[-51]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N93").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-52]C[8]+R[-49]c[8]+R[-51]c[8])/1000"                '''''Fixed Deposits/SD/Others        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G95").Select        ActiveCell.FormulaR1C1 = "=(R[-48]C)/1000"        Range("G95").Select        Selection.AutoFill Destination:=Range("G95:K95"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-48]C[-1]:R[-48]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-48]C:R[-48]C[7])/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-48]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-48]C[8])/1000"                       '''''CDs        '1M - 12M and the rest                        '<1M                        '>1Y                        'Non-Rate                        'Total                    '''''Derivatives        wbTarget.Sheets(I).Range("G97").Select        ActiveCell.FormulaR1C1 = "=(R[-40]C)/1000"        Range("G97").Select        Selection.AutoFill Destination:=Range("G97:K97"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-40]C[-1]:R[-40]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-40]C:R[-40]C[7])/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-40]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-40]C[8])/1000"                '''''Funding Swaps        wbTarget.Sheets(I).Range("G98").Select        ActiveCell.FormulaR1C1 = "=(R[-37]C)/1000"        Range("G98").Select        Selection.AutoFill Destination:=Range("G98:K98"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F98").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-37]C[-1]:R[-37]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L98").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-37]C:R[-37]C[7])/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M98").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-37]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N98").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-37]C[8])/1000"                 End If        Next I        wb.Close SaveChanges:=True    wbTarget.Close SaveChanges:=True     End Sub
Sub MakeTableUSDMY()
    Dim wb       As Workbook    Dim wbTarget As Workbook    Dim sheetTargetName As String    Dim WS_Count As Integer    Dim I As Integer
'    Set wb = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\GenerateTablesFormulas.xlsx")'    Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")'    WS_Count = ActiveWorkbook.Worksheets.Count
    'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")        'Table Formulas Template    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))        'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    targetPath = ThisWorkbook.Sheets("Sheet1").Range("H6")    'Name of File eg Report.xlsx    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("H7"))        'Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")    WS_Count = ActiveWorkbook.Worksheets.Count    Debug.Print WS_Count
    ' Begin the loop.    For I = 1 To WS_Count            wbTarget.Sheets(I).Select            If ActiveSheet.name = "MY_USD" Then            'Copy and Paste the format of table        With wb.Sheets("USDTableTemplate").UsedRange            .Copy        End With                With wbTarget.Sheets(I).Range("D82")            .PasteSpecial        End With            'Make the formulas                'Interbank Placement        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G84").Select        ActiveCell.FormulaR1C1 = "=((R[-80]C)*R2C25/1000)"        Range("G84").Select        Selection.AutoFill Destination:=Range("G84:K84"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-80]C[-1]:R[-80]C)*R2C25/1000"                '>1Y        wbTarget.Sheets(I).Range("L84").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-80]C:R[-80]C[7])*R2C25)/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-80]C[8]*R2C25)/1000"                'Total        wbTarget.Sheets(I).Range("N84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-80]C[8]*R2C25)/1000"                '''''Corporate Bonds        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G85").Select        ActiveCell.FormulaR1C1 = "=(R[-76]C)/1000*R2C25"        Range("G85").Select        Selection.AutoFill Destination:=Range("G85:K85"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[-1]:R[-76]C)/1000*R2C25"                '>1Y        wbTarget.Sheets(I).Range("L85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C:R[-76]C[7])/1000*R2C25"                'Non-Rate        wbTarget.Sheets(I).Range("M85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[8])/1000*R2C25"                'Total        wbTarget.Sheets(I).Range("N85").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[8])/1000*R2C25"                        '''''Government Bonds and T - Bills        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G86").Select        ActiveCell.FormulaR1C1 = "=(R[-76]C)/1000*R2C25"        Range("G86").Select        Selection.AutoFill Destination:=Range("G86:K86"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[-1]:R[-76]C)/1000*R2C25"                '>1Y        wbTarget.Sheets(I).Range("L86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C:R[-76]C[7])/1000*R2C25"                'Non-Rate        wbTarget.Sheets(I).Range("M86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[8])/1000*R2C25"                'Total        wbTarget.Sheets(I).Range("N86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[8])/1000*R2C25"                    '''''Customer Loans        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G87").Select        ActiveCell.FormulaR1C1 = "=(R[-76]C)/1000*R2C25"        Range("G87").Select        Selection.AutoFill Destination:=Range("G87:K87"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[-1]:R[-76]C)/1000*R2C25"                '>1Y        wbTarget.Sheets(I).Range("L87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C:R[-76]C[7])/1000*R2C25"                'Non-Rate        wbTarget.Sheets(I).Range("M87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[8])/1000*R2C25"                'Total        wbTarget.Sheets(I).Range("N87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[8])/1000*R2C25"            '''''Interbank Borrowing        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G90").Select        ActiveCell.FormulaR1C1 = "=(R[-68]C)/1000*R2C25"        Range("G90").Select        Selection.AutoFill Destination:=Range("G90:K90"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C[-1]:R[-68]C)/1000*R2C25"                '>1Y        wbTarget.Sheets(I).Range("L90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C:R[-68]C[7])/1000*R2C25"                'Non-Rate        wbTarget.Sheets(I).Range("M90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C[8])/1000*R2C25"                'Total        wbTarget.Sheets(I).Range("N90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C[8])/1000*R2C25"                '''''Current Account LIBOR        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G92").Select        ActiveCell.FormulaR1C1 = "=(R[-66]C)/1000*R2C25"        Range("G92").Select        Selection.AutoFill Destination:=Range("G92:K92"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F92").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-66]C[-1]:R[-66]C)/1000*R2C25"                '>1Y        wbTarget.Sheets(I).Range("L92").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-66]C:R[-66]C[7])/1000*R2C25"                'Non-Rate        wbTarget.Sheets(I).Range("M92").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-66]C[8])/1000*R2C25"                'Total        wbTarget.Sheets(I).Range("N92").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-66]C[8])/1000*R2C25"                '''''Fixed Deposits/SD/Others        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G95").Select        ActiveCell.FormulaR1C1 = "=((R[-68]C+R[-66]C)/1000)"        Range("G95").Select        Selection.AutoFill Destination:=Range("G95:K95"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C[-1]:R[-68]C+R[-66]C[-1]:R[-66]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L95").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-68]C:R[-68]C[7])+SUM(R[-66]C:R[-66]C[7]))/1000"                'Non-Rate        wbTarget.Sheets(I).Range("M95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-67]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C[8])/1000*R2C25"                 '''''Derivatives        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G97").Select        ActiveCell.FormulaR1C1 = "=(R[-62]C)/1000*R2C25"        Range("G97").Select        Selection.AutoFill Destination:=Range("G97:K97"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-62]C[-1]:R[-62]C)/1000*R2C25"                '>1Y        wbTarget.Sheets(I).Range("L97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-62]C:R[-62]C[7])/1000*R2C25"                'Non-Rate        wbTarget.Sheets(I).Range("M97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-62]C[8])/1000*R2C25"                'Total        wbTarget.Sheets(I).Range("N97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-62]C[8])/1000*R2C25"
        End If        Next I        wb.Close SaveChanges:=True    wbTarget.Close SaveChanges:=True     End Sub
Sub MakeTableUSDOWH()
    Dim wb       As Workbook    Dim wbTarget As Workbook    Dim sheetTargetName As String    Dim WS_Count As Integer    Dim I As Integer
'    Set wb = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\GenerateTablesFormulas.xlsx")'    Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")'    WS_Count = ActiveWorkbook.Worksheets.Count
'    'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"'    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")''    'Table Formulas Template'    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))'    'Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")'    WS_Count = ActiveWorkbook.Worksheets.Count''    'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"'    targetPath = ThisWorkbook.Sheets("Sheet1").Range("C6")'    'Name of File eg Report.xlsx'    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("C7"))        'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")        'Table Formulas Template    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))        'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    targetPath = ThisWorkbook.Sheets("Sheet1").Range("H6")    'Name of File eg Report.xlsx    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("H7"))        'Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")    WS_Count = ActiveWorkbook.Worksheets.Count    Debug.Print WS_Count
    ' Begin the loop.    For I = 1 To WS_Count            wbTarget.Sheets(I).Select            If ActiveSheet.name = "OWH_USD" Then            'Copy and Paste the format of table        With wb.Sheets("USDOWHTableTemplate").UsedRange            .Copy        End With                With wbTarget.Sheets(I).Range("D82")            .PasteSpecial        End With            'Make the formulas                'Interbank Placement        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G84").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G84").Select        Selection.AutoFill Destination:=Range("G84:K84"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F84").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L84").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M84").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N84").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '''''Corporate Bonds        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G85").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G85").Select        Selection.AutoFill Destination:=Range("G85:K85"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F85").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L85").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M85").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N85").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                        '''''Government Bonds and T - Bills        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G86").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G86").Select        Selection.AutoFill Destination:=Range("G86:K86"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F86").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L86").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M86").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N86").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                    '''''Customer Loans        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G87").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G87").Select        Selection.AutoFill Destination:=Range("G87:K87"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F87").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L87").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M87").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N87").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '''''Administered        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G88").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G88").Select        Selection.AutoFill Destination:=Range("G88:K88"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F88").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L88").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M88").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N88").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"            '''''Interbank Borrowing        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G90").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G90").Select        Selection.AutoFill Destination:=Range("G90:K90"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F90").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L90").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M90").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N90").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '''''Commercial Papers/Debt Issued        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G91").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G91").Select        Selection.AutoFill Destination:=Range("G91:K91"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F91").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L91").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M91").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N91").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '''''Current Account LIBOR        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G92").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G92").Select        Selection.AutoFill Destination:=Range("G92:K92"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F92").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L92").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M92").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N92").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '''''Current Account Administered        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G93").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G93").Select        Selection.AutoFill Destination:=Range("G93:K93"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F93").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L93").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M93").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N93").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '''''Savings Accounts        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G94").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G94").Select        Selection.AutoFill Destination:=Range("G94:K94"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F94").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L94").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M94").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N94").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '''''FD/CD/Other Deposits        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G95").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"        Range("G95").Select        Selection.AutoFill Destination:=Range("G95:K95"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F95").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                '>1Y        wbTarget.Sheets(I).Range("L95").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Non-Rate        wbTarget.Sheets(I).Range("M95").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"                'Total        wbTarget.Sheets(I).Range("N95").Select        ActiveCell.FormulaR1C1 = "=(R[-80]C[-2])"
        End If        Next I        wb.Close SaveChanges:=True    wbTarget.Close SaveChanges:=True     End Sub
Sub MakeTableUSDBOS()
    Dim wb As Workbook    Dim wbTarget As Workbook    Dim sheetTargetName As String    Dim WS_Count As Integer    Dim I As Integer
'    Set wb = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\GenerateTablesFormulas.xlsx")'    Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")'    WS_Count = ActiveWorkbook.Worksheets.Count
'    'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"'    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")''    'Table Formulas Template'    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))'    'Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")'    WS_Count = ActiveWorkbook.Worksheets.Count''    'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"'    targetPath = ThisWorkbook.Sheets("Sheet1").Range("C6")'    'Name of File eg Report.xlsx'    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("C7"))        'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")        'Table Formulas Template    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))        'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    targetPath = ThisWorkbook.Sheets("Sheet1").Range("H6")    'Name of File eg Report.xlsx    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("H7"))        'Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")    WS_Count = ActiveWorkbook.Worksheets.Count    Debug.Print WS_Count
    ' Begin the loop.    For I = 1 To WS_Count            wbTarget.Sheets(I).Select            If ActiveSheet.name = "BOS_USD" Then            'Copy and Paste the format of table        With wb.Sheets("USDBOSTableTemplate").UsedRange            .Copy        End With                With wbTarget.Sheets(I).Range("D82")            .PasteSpecial        End With            'Make the formulas                'Interbank Placement        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G84").Select        ActiveCell.FormulaR1C1 = "=((R[-73]C)/1000)"        Range("G84").Select        Selection.AutoFill Destination:=Range("G84:K84"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-73]C[-1]:R[-73]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L84").Select        ActiveCell.FormulaR1C1 = "=(SUM(R[-73]C:R[-73]C[11]))/1000"        '        'Non-Rate'        wbTarget.Sheets(I).Range("M84").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-73]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N84").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-73]C[10])/1000"                '''''Corporate Bonds'        '1M - 12M and the rest'        wbTarget.Sheets(I).Range("G85").Select'        ActiveCell.FormulaR1C1 = "=(R[-76]C)/1000*R2C25"'        Range("G85").Select'        Selection.AutoFill Destination:=Range("G85:K85"), Type:=xlFillDefault''        '<1M'        wbTarget.Sheets(I).Range("F85").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[-1]:R[-76]C)/1000*R2C25"''        '>1Y'        wbTarget.Sheets(I).Range("L85").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C:R[-76]C[7])/1000*R2C25"''        'Non-Rate'        wbTarget.Sheets(I).Range("M85").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[8])/1000*R2C25"''        'Total'        wbTarget.Sheets(I).Range("N85").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-76]C[8])/1000*R2C25"                '''''Government Bonds and T - Bills        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G86").Select        ActiveCell.FormulaR1C1 = "=(R[-72]C)/1000"        Range("G86").Select        Selection.AutoFill Destination:=Range("G86:K86"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-72]C[-1]:R[-72]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-72]C:R[-72]C[11])/1000"        '        'Non-Rate'        wbTarget.Sheets(I).Range("M86").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-72]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N86").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-72]C[10])/1000"                    '''''Customer Loans        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G87").Select        ActiveCell.FormulaR1C1 = "=(R[-68]C)/1000"        Range("G87").Select        Selection.AutoFill Destination:=Range("G87:K87"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C[-1]:R[-68]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C:R[-68]C[11])/1000"        '        'Non-Rate'        wbTarget.Sheets(I).Range("M86").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-72]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N87").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C[10])/1000"            '''''Interbank Borrowing        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G90").Select        ActiveCell.FormulaR1C1 = "=(R[-67]C)/1000"        Range("G90").Select        Selection.AutoFill Destination:=Range("G90:K90"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-67]C[-1]:R[-67]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-67]C:R[-67]C[11])/1000"        '        'Non-Rate'        wbTarget.Sheets(I).Range("M86").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-72]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N90").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-67]C[10])/1000"                '''''Current Account LIBOR        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G92").Select        ActiveCell.FormulaR1C1 = "=(R[-66]C)/1000"        Range("G92").Select        Selection.AutoFill Destination:=Range("G92:K92"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F92").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-66]C[-1]:R[-66]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L92").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-66]C:R[-66]C[11])/1000"        '        'Non-Rate'        wbTarget.Sheets(I).Range("M86").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-72]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N92").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-66]C[10])/1000"                '''''Fixed Deposits/SD/Others        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G95").Select        ActiveCell.FormulaR1C1 = "=(R[-68]C)/1000"        Range("G95").Select        Selection.AutoFill Destination:=Range("G95:K95"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C[-1]:R[-68]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C:R[-68]C[11])/1000"        '        'Non-Rate'        wbTarget.Sheets(I).Range("M86").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-72]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N95").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-68]C[10])/1000"                 '''''Derivatives        '1M - 12M and the rest        wbTarget.Sheets(I).Range("G97").Select        ActiveCell.FormulaR1C1 = "=(R[-54]C)/1000"        Range("G97").Select        Selection.AutoFill Destination:=Range("G97:K97"), Type:=xlFillDefault                '<1M        wbTarget.Sheets(I).Range("F97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-54]C[-1]:R[-54]C)/1000"                '>1Y        wbTarget.Sheets(I).Range("L97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-54]C:R[-54]C[11])/1000"        '        'Non-Rate'        wbTarget.Sheets(I).Range("M86").Select'        ActiveCell.FormulaR1C1 = "=SUM(R[-72]C[8])/1000"                'Total        wbTarget.Sheets(I).Range("N97").Select        ActiveCell.FormulaR1C1 = "=SUM(R[-54]C[10])/1000"
        End If        Next I        wb.Close SaveChanges:=True    wbTarget.Close SaveChanges:=True     End Sub

