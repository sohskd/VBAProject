Sub MakeReportTableIDR()
    Dim wb       As Workbook    Dim wbTarget As Workbook    Dim sheetTargetName As String    Dim s As String    '    Original HardCode'    Set wb = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\GenerateTablesFormulas.xlsx")'    Set wbTarget = Workbooks.Open("C:\Users\A9900899\Desktop\Desmond\VBAProject\TestFolder\Report.xlsx")    sheetTargetName = "IDR_NII_Sensitivity"        'Path of table template file eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    tableTemplatePath = ThisWorkbook.Sheets("Sheet1").Range("D33")        'Table Formulas Template    Set wb = Workbooks.Open(tableTemplatePath & ThisWorkbook.Sheets("Sheet1").Range("D34"))        'Path of Target File eg "C:\Users\A9900899\Desktop\Desmond\VBAProject\"    targetPath = ThisWorkbook.Sheets("Sheet1").Range("W6")    'Name of File eg Report.xlsx    Set wbTarget = Workbooks.Open(targetPath & ThisWorkbook.Sheets("Sheet1").Range("W7"))        'Paste the format of table    With wb.Sheets("IDRReportTemplate").UsedRange        .Copy    End With
    wbTarget.Sheets(sheetTargetName).Select    With wbTarget.Sheets(sheetTargetName).Range("C1")        .PasteSpecial    End With        'Variables to loop through    sReport = "EFGHIJKLM"    sSource = "FGHIJKLMN"        'Generating INTEREST EARNING ASSETS    'Go vertical down    For J = 5 To 9        'Go across        For I = 1 To Len(sReport)                wbTarget.Sheets(sheetTargetName).Range(Mid(sReport, I, 1) & J) = "=NISP_IDR!" & Mid(sSource, I, 1) & J + 79 _            Next    Next        'Generating INTEREST BEARING LIABILITIES    'Go vertical down    For J = 11 To 18        'Go across        For I = 1 To Len(sReport)                wbTarget.Sheets(sheetTargetName).Range(Mid(sReport, I, 1) & J) = "=NISP_IDR!" & Mid(sSource, I, 1) & J + 79 _
        Next    Next        'Close and save all files    wb.Close SaveChanges:=True    wbTarget.Close SaveChanges:=True   End Sub


